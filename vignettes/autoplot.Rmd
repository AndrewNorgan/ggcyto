---
title: "Quick plot for cytometry data"
output:
  html_document:
    fig_height: 2
    fig_width: 5
    keep_md: yes
---

```{r, echo=FALSE}
library(knitr)
opts_chunk$set(message = FALSE, warning = FALSE)
```

```{r}
library(ggcyto)
gs <- load_gs("/fh/fast/gottardo_r/mike_working/HVTN/086/orig/1665-Y-086/")
gs <- gs[1:2]
data(GvHD)
fs <- GvHD[subset(pData(GvHD), Patient %in%5 & Visit %in% c(5:6))[["name"]]]
```

## `flowSet`
```{r}
## 1d densityplot
autoplot(fs, x = 'FSC-H')

## 2d hex
autoplot(fs, x = 'FSC-H', y = 'SSC-H', bins = 64)
```

## `GatingSet` 
```{r}
# apply the instrument range by default
# use direct parent
# inverse trans axis
p <- autoplot(gs, "3+", bins = 64)
p

# display marker only
p + labs_cyto("marker")

# display channel only
p + labs_cyto("channel")

# multiple
autoplot(gs, c("4+", "8+"), bins = 64)
```

## `GatingHierarchy`
```{r, fig.height = 4}
gh <- gs[[1]]
nodes <- c("Lv", "L", "3+", "4+", "8+")
# default use grid.arrange
autoplot(gh, nodes, bins = 64)

# disable arrange and receive a list of ggplot objects to manually arrange
objs <- autoplot(gh, nodes, bins = 64, arrange = F)
length(objs)
class(objs[[1]])
class(objs[[2]])

```

