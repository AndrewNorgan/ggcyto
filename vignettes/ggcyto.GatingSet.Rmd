---
title: "Visualize GatingSet with ggcyto"
author: "Mike Jiang"
date: "04/13/2015"
---

```{r, echo=FALSE}
library(knitr)
opts_chunk$set(message = FALSE, warning = FALSE)
```


```{r echo=FALSE}
library(ggcyto)
gs <- load_gs("/fh/fast/gottardo_r/mike_working/lyoplate_out//gated_data/auto/gslist-tcell/D54tFo7RPl/")
gs <- gs[1:2]
# library(proto)
# library(plyr)
# source("~/rglab/workspace/ggcyto/R/ggcyto.R")
# source("~/rglab/workspace/ggcyto/R/ggcyto-flowSet.R")
# source("~/rglab/workspace/ggcyto/R/ggcyto-GatingSet.R")
```

```{r}
p <- ggcyto(gs, aes(x = `CD4`, y = `CD8`), subset = "CD3") 
# 2d plot
p <- p + geom_hex(bins = 128) + xlim(0,4096) + ylim(0,4096)
p

# add gate
p + geom_gate("CD4")

# add two gates
p + geom_gate(c("CD4","CD8")) # short for geom_gate("CD8") + geom_gate("CD4")

```

```{r error=T}
# 'subset' is abstract without specifiying it
p <- ggcyto(gs, aes(x = `CD4`, y = `CD8`)) + geom_hex(bins = 128) + xlim(0,4096) + ylim(0,4096)
p
```

```{r}

# it can be instantiated by gate layer
p + geom_gate(c("CD4", "CD8"))

# plot all children of the specified parent
p <- ggcyto(gs, aes(x = `CD4`, y = `CD8`), subset = "CD3") + geom_hex(bins = 128) + xlim(0,4096) + ylim(0,4096)
p + geom_gate()

# add gates to the arbitary(non-parent) node
p2 <- ggcyto(gs, subset = "Live", aes(x = `CD4`, y = `CD8`)) + geom_hex(bins = 128) + xlim(0,4096) + ylim(0,4096)
p2 + geom_gate(c("CD4", "CD8"))

# 1d gate
ggcyto(gs, aes(x = `CD3`, y = `SSC-A`)) + geom_hex(bins = 128) + geom_gate("CD3")


```



